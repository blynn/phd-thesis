\chapter{Curve Selection}

Let $E$ be an elliptic curve defined over a finite field $K$.
Let $P \in E(K)$ be a point of prime order $r$. Let $G = \langle P \rangle$.

We intend to build cryptosystems that operate in $G$. Hence
we perform field arithemtic in $K$ during cryptographic operations,
while the security of the resulting systems partly depends on the size of $r$.
Recall the size of $K$ is roughly the size of $\#E(K)$,
thus we desire $r$ to be as close to $\#E(K)$ as possible. Ideally,
$r$ and $\#E(K)$ are the same size, both being say $l$-bit numbers,
meaning we have $l$-bit security
in $G$ and the running times depend on operations on $l$-bit numbers.

We focus on this case, namely when
$r$ and $\#E(K)$ take roughly the same number of
bits. Relaxing this condition
permits us to use a wider variety of pairings, and we discuss one
such case later.

If $L$ is a field extension of $K$
that contains the $r$th roots of unity (so $r$ divides $|L| - 1$),
then the Tate pairing
on $G$ can be computed by performing operations in $L$.

On the other hand, let $E[r]$ denote the group of points of order $r$.
The Weil pairing is defined on $E[r]$. For some field extension
$L'$ of $K$, $E(L')$ contains $E[r]$, and the Weil pairing can be
computed by performing operations in $L'$.

In order for the Tate pairing to be efficiently computable,
operations must be efficient in $L$.
Similarly, for the Weil pairing to be efficiently
computable, operations must be efficient in $L'$.
Thus we seek fields $L$ or $L'$ that are small enough so that field
operations are still fast.

We will define the \emph{embedding degree} which can be thought of as measuring
how much larger $L$ or $L'$ is compared to the field $K$.

It turns out that such a field $L'$ will always contain the $n$th
roots of unity, thus we always have $L \subseteq L'$.
The converse is not true: it is possible for the subset inclusion to be strict.
In other words, for a field $L$ to contain the $r$th roots of unity but
at the same time have part of $E[r]$ lying outside $E(L)$.

However, as Balasubramanian and Koblitz have shown~\cite{bk},
the converse is almost true (though the proof here is slightly different):

\section {The Embedding Degree}

\begin{theorem}
Let $E$ be an elliptic curve defined over $\mathbb{F}_q$.
Let $G$ be a subgroup of $E(\Fq)$ of order $r$ with
$r \nmid q-1$.
Then for any positive integer $k$,
$E(\mathbb{F}_{q^k})$ contains all $r^2$
points of order $r$ if and only if $r \mid q^k - 1$.
\end{theorem}

\begin{proof}
It is well-known that if $E(\mathbb{F}_{q^k})$ contains $E[r]$
then $r \mid q^k - 1$, even without assuming $r \mid N$ or
$r \nmid q-1$~\cite{bk}.

Conversely, suppose $k > 1$ and $r \mid q^k - 1$.
Let $\Phi$ denote the Frobenius map. Consider the subgroup $T$ of $E[r]$
consisting of all points of trace zero, that is
\[
T = \{ Q \in E[r] : \tr Q = Q + \Phi(Q) + ... + \Phi^{k-1}(Q) = O \}
\]
(The group $T$ may be explicitly constructed by using the map $P \mapsto
P - \Phi(P)$ on points of $E(\mathbb{F}_{q^k})$.)
Now we have $\Phi(T) = T$, and also $T$ is not contained
in $E(\mathbb{F}_q)$ by assumption.

Hence $T$ is an eigenspace of $\Phi$, but not the $1$-eigenspace. Since the
eigenvalues of $\Phi$ must be $1$ and $q$, we see that $T$ must be the
$q$-eigenspace of $\Phi$ and hence
\[
\Phi^k(Q) = q^k Q = Q
\]
since $r \mid q^k - 1$. Thus $T$, like $E(\mathbb{F}_q)$ is fixed under
$\Phi^k$, and since these groups are linearly independent they generate all
of $E[r]$, implying that all of $E[r]$ is fixed under $\Phi^k$. Hence
$E[r] \subset E(\mathbb{F}_{q^k})$.
\end{proof}

\begin{definition}
Let $E$ be an elliptic curve defined over $K = \mathbb{F}_q$.
Let $G \subseteq E(\Fq)$ be a cyclic group of order $r$.
Let $k$ be the smallest positive integer such that $r \mid q^k - 1$.
Then we say that the embedding degree of $G$ is $k$.
\end{definition}

As already mentioned, we mostly focus on curves where
$r$ and $\#E(K)$ are as close as possible.
For this case, we can abuse the terminology a little
when talking about embedding degrees: when we speak of an embedding degree
of a curve $E(\Fq)$, we mean the embedding degree of the subgroup of
$E(\Fq)$ of order $r$ where $r$ is the largest prime dividing $\#E(\Fq)$
(or in some applications, the largest factor of $\#E(\Fq)$ that cannot be
efficiently factored).

There is a related subtlety we must mention.
Let $P \in E(K)$ be a point of order $r$.
Let $G = \langle P \rangle$.
Let $n = \#E(\Fq)$.
We shall often determine the embedding degree of $G$
by finding the smallest integer $k$ such that $n \mid q^k - 1$
(a process that does not involve $r$ is any way).
If $r$ is a proper factor of $n$,
then it could be that for some $j < k$, although $n \nmid q^j - 1$,
we have $r \mid q^j - 1$, that is,
$\mathbb{F}_{q^j}$ contains all the $r$th roots of unity and this
subfield of $\mathbb{F}_{q^k}$ suffices for
the Tate pairing computation on $G$.

However, in practice, when we do use such a group $G$ and
$r$ is a large prime factor of $\#E(\Fq)$ it is almost always the case that
$\mathbb{F}_{q^k}$ is the smallest field extension that allows the computation
of the pairing.

In other words, in general, for a cyclic subgroup $G \subset \#E(\Fq)$
the embedding degree $k$ of $E(\Fq)$
may not be the smallest positive integer such that $r \mid q^k - 1$ but
in practice, when $r$ is a large prime factor of $\#E(\Fq)$,
the probability that $k$ is not the integer we seek is negligible.
Below, we shall make statements
about embedding degrees ignoring the unlikely event that the
real embedding degree could be smaller.
(Note for small toy examples it is more likely that there exists
some $j < k$ with $r \mid q^j - 1$.)

At this point, our goal seems to be minimizing this embedding degree,
so that $L$ is as close as possible to $K$, and if possible,
to have $K = L$ and have all computations in a
small a field as possible.
Unfortunately, things are not quite this simple, because of
pairing security issues which we will soon examine in
Section~\ref{sec:pairingsec}.

\section {Weil and Tate Pairing Comparison}

The above theorem shows that if the embedding degree $k$ is greater than 1,
then both the Tate pairing and the Weil pairing may be computed by
performing field arithmetic in $\mathbb{F}_{q^k}$.

On the other hand, if the embedding degree $k$ is 1, the Tate pairing may
be computable in $\mathbb{F}_q$, but the Weil pairing may not be.
Usually this is not significant because we shall see
$k > 1$ is preferred.
Nonetheless, we shall find the Tate pairing to be the best choice in
any case for other reasons.

Consider the curve $E: Y^2 = X^3 + X + 6$ which has
18 points over $\mathbb{F}_{19}$, which we borrow from a publication by
Balasubramanian and Koblitz~\cite{bk}.
The point $R=(0,5)$ generates a cyclic group of order 18,
so the point $P = 6R = (12,13)$ generates a cyclic group of order 3.

We see $E[3]$ cannot be contained in $\langle R \rangle = E(\mathbb{F}_{19})$
since $E[3]$ is not cyclic, thus the Weil pairing cannot be computed.
(In fact, we must move to $\mathbb{F}_{19^3}$ to do so.)

In contrast, $3 \mid 19-1$ hence the Tate pairing can be
computed in $\mathbb{F}_{19}$. In fact, we find $e(P, R + 3G) = 11$, where
$e$ denotes the Tate pairing.
(Recall that pairings are only unique up to a constant, so different
implementations may give different results.
Sjnce the cube roots of unity in
$\mathbb{F}_{19}$ are $1, 7, 11$, we expect $7$ or $11$.)

\subsection {\label{sec:compositeexample} Composite Group Orders}

We can also use this curve to exhibit
interesting behaviour that can occur with
pairings on cyclic groups with composite order mentioned in Section~\ref{sec:generalpairing}.

It can be checked that $e(R, R) = 17$, a ninth root of unity.
(If were to strictly adhere to the definition of the Tate pairing
the second input should be written as $R + 18G$ since it is supposed to be
a coset, but this is superfluous since $18G$ is the trivial group.)
Thus we have a pairing that maps two groups of order 18
to a group that has order 9.
This implies, for example, $e(R, 9R) = 1$.

In contrast, if the order of $R$ were some prime $r$, nondegeneracy implies
that $e(P, Q)$ must also be of order $r$ for any
$P, Q \in \langle R \rangle \setminus \{ O \}$.
In fact, $e(P, Q) = 1$ would imply at least one of $P, Q$ is $O$ in this case.
Because most pairing-based cryptosystems use groups of prime order,
one may become so accustomed to facts like these that one may erroneously
assume them to be true when working with groups of composite order.

\section { \label{sec:pairingsec} Pairing Security}

Consider a nonsingular elliptic curve $E$ over finie field $\Fq$ containing
some cyclic group $G$ of order $r$ with
embedding degree $k$.

In some sense, the pairing is a double-edged sword. Though it
bestows additional cryptographically useful properties upon cyclic groups,
it also allows one to break the discrete log problem in $E(\Fq)$
by first breaking the discrete log problem in $\Fqk$,
using an algorithm known as the MOV or Frey-Ruck attack~\cite{mov,fr}
which we now describe.

Suppose we are given $P, nP \in G$ and asked to recover $n$.
Let $e : G \times G \rightarrow \Fqk$ be a bilinear, nondegenerate map,
such as the Weil or Tate pairing.

By bilinearity and nondegeneracy,
\[ \dlog ( e(P,P), e(P, nP) )
= \dlog (e(P,P),e(P,P)^n) = n = \dlog(P,nP) \]
for $n \in \{0,...,r-1\}$.

Since $e(P,P), e(P, nP) \in \Fqk$,
we can use a method like index calculus
to recover $n$, the solution
to the discrete log problem in the elliptic curve group $G$.

Interestingly, these attacks were the first application of pairings
in cryptography to appear in the literature,
predating all publications describing
constructive uses of the pairing.

To avoid them, we must ensure $q^k$ is large enough so that
finite field discrete logarithm algorithms such as index calculus are
infeasible in $\mathbb{F}_{q^k}$.

It may seem we have contradicted ourselves, for in Section~\ref{sec:eccsec}
we touted elliptic curves over finite fields because we claimed they
are only susceptible to generic discrete log attacks, yet we have just seen
we must guard against index calculus.

But although it is true that a pairing exists
for every nonsingular elliptic curve, in general
the embedding degree $k$ is so large that it is futile to mount a MOV or
Frey-Ruck attack on a typical elliptic curve
because $\Fqk$ will be too large for any
practical calculations.

Normally we shun such curves in standard elliptic curve cryptography
and can ignore these attacks, which is why they were not mentioned before.
The newfound utility of pairings has meant 
we actively seek out curves with low embedding degrees (so that pairings
are efficiently computable)
and now we do need to take these attacks into account.

Are there any other attacks that concern us? It turns out
the curves used in pairing-based cryptography are special in other senses.
They are supersingular, or have complex multiplication.
Fortunately, no specific attacks for either case is known.

\section {Lower Bounds on Field and Group Sizes}

Constructing a pairing is a delicate balancing act.
Using the notation of the previous section,
$\Fq$ must be large enough
so that $E(\Fq)$ can foil generic discrete log attacks, while $\Fqk$ must be
large enough to resist finite field discrete log attacks. At the same time,
$\Fq$ and $\Fqk$ should be as small as possible to minimize time and space
usage. More precisely:

\begin{enumerate}
\item
$r$ must be a large enough prime so that generic discrete logarithm attacks
in a group of order $r$ are ineffective. Since $q \approx \#E(\mathbb{F}_q)$,
this places a similar lower bound on $q$.
\item
$q$ ought to be as small as possible, so that computations in $\mathbb{F}_q$
are as fast as possible.
\item
$q^k$ must be large enough so that finite field discrete logarithm attacks
in $\mathbb{F}_{q^k}$ are ineffective. Also
$q$ should not have low Hamming weight~\cite{stinson}, nor be a power of
a small prime~\cite{coppersmith}.
\item
$q^k$ must be small enough so that operations in $\mathbb{F}_{q^k}$
are efficient. All other things being equal,
$q^k$ should be small as possible so that operations
are as fast as possible.
\end{enumerate}

Observe the first three statements are true for any cryptographically
useful elliptic curve, not just for pairing-based cryptography.
The last condition, requiring $\Fqk$ to be small enough to compute on,
is responsible for much of the difficulty in pairing-based cryptography
research, as finding curves with small $k$ is nontrivial.

Currently it is acceptable to have an 160-bit $r$.
As for $q^k$, 1024 bits is adequate for many applications, and calculations
in fields of this size can certainly be performed.
Ideally we have $r \approx \#E(\mathbb{F}_q) \approx q$
and hence $q$ is also about 160 bits. This gives an
embedding degree $k$ around $1024 / 160 = 6.4$.

We later describe how to construct curves of embedding degree 6, 10 and 12.
For the near future, embedding degree 6 should be reasonable if used along
with an $r$ that is at least $170$ bits long,
while embedding degree 10 and 12 curves which currently produce excessively
large finite fields may be more desirable as time passes and index calculus
improvements are discovered.

\section {Approaches to Finding Curves}

A randomly-chosen elliptic curve will have a large embedding
degree, which endows it with resistance to the MOV and Frey-Ruck
attacks, but also renders it useless for pairing-based cryptography.
We must take one of two approaches to find curves suitable for pairings:

\begin{enumerate}
\item
Supersingular curves are guaranteed to have a small embedding degree,
and are easy to construct. They have been completely classified. Operations
on some of them can be highly optimized.
\item
By carefully tailoring the complex multiplication method of constructing
elliptic curves, we can produce curves of a certain embedding degree. 
\end{enumerate}

We note that supersingular hyperelliptic curves have also been
considered~\cite{galbraith, rubinsilverberg},
and as well as the hyperelliptic equivalent of the
complex multiplication method~\cite{freemanhyper}.

Below we survey some types of curves used in practice for pairing-based
cryptography. To make them easier to refer to, we label them with letters.
The labelling is arbitrary, though we try to arrange them in the order
they appeared in cryptography publications.

\section {Supersingular Curves}

There are six families of supersingular curves, with embedding degree at
most six \cite{mov}. Let $q=p^m$. Let $t$ denote the trace of Frobenius.
Then the six classes can be described as follows.

\begin{enumerate}
\item
$k = 2$: $ t = 0$ and $E(\mathbb{F}_q) \cong \mathbb{Z}_{q+1}$.
\item
$k = 2$: $ t = 0$ and $E(\mathbb{F}_q) \cong \mathbb{Z}_{(q+1)/2} \oplus \mathbb{Z}_2$ and $q = 3 \pmod{4}$.
\item
$k = 3$: $ t^2 = q$ and $m$ is even.
\item
$k = 4$: $ t^2 = 2q$ and $p = 2$ and $m$ is odd.
\item
$k = 6$: $ t^2 = 3q$ and $p = 3$ and $m$ is odd.
\item
$k = 1$: $ t^2 = 4q$ and $m$ is even.
\end{enumerate}

Some curves in the first two classes are easy to describe, and are
extremely useful, as it is easy to find curves containing a
subgroup of any desired order.

The $k=4$ case requires $p=2$.
Many specialized optimizations exist for
operations in characteristic two fields,
but unfortunately at the same time specialized discrete logarithm attacks
exist \cite{coppersmith}, and we must use bigger fields to compensate for
this. 

The $k=6$ case requires $p=3$. Again, we may apply
a host of specialized optimizations, but we must also be wary of
low-characteristic discrete logarithm algorithms.

\section {Type A Curves}

Let $q$ be a prime satisfying $q = 3 \pmod{4}$.
Let $E$ be the curve $y^2 = x^3 + x$. It can be shown \cite{silverman}
that $E(\mathbb{F}_q)$ is supersingular and $k = 2$.

We have $\#E(\mathbb{F}_q) = q+1$, and $\#E(\mathbb{F}_{q^2}) = (q+1)^2$,
thus for any $P\in E(\mathbb{F}_q)$
the embedding degree of $G = \langle P \rangle$ is 2.

Note $-1$ is a quadratic nonresidue in $\mathbb{F}_q$ since $q = 3\pmod{4}$.
Let $i$ be a square root of $-1$. Then $\mathbb{F}_q[i]$ is a degree 2
extension of $\Fq$.
Consider the following map, sometimes referred to as a distortion map:
\[ \Psi(x, y) = (-x, i y) \]

Then $\Psi$ maps points of $E(\mathbb{F}_q)$ to points of
$E(\mathbb{F}_{q^2}) \setminus E(\mathbb{F}_q)$. Thus if $f$ denotes the
Tate or Weil pairing, then defining $e:G \times G \rightarrow \mathbb{F}_{q^2}$
by

\[ e(P,Q) = f(P, \Psi(Q)) \]

gives a bilinear nondegenerate map.

Setup for this type of pairing for a cryptosystem can be done as follows.

\begin{enumerate}
\item
An order $r$ is chosen, large enough to avoid generic discrete logarithm
attacks. Other properties may be desired. For some cryptosystems $r$ is
an RSA modulus. As we will see, careful choices of $r$ will speed up Miller's
algorithm substantially.
\item
Recall we require finite field discrete logarithm attacks on $\mathbb{F}_{q^2}$
to be impractical. Thus a random multiple of four $h$ is generated,
where $h$ is large enough to guarantee $(hr)^2$ is big enough to resist
finite field attacks. For example, if $r$ is 160 bits long, and we want
$q^2$ about 1024 bits long, then $h$ must be about 352 bits long.
\item
Next it is checked that $q = h r - 1$ is prime.
If not, we go back to the previous step.
\item
For some cryptosystems problems may arise if $r \nmid h$, but this occurs
with negligible probability for realistic parameters. Nonetheless, when toy
examples are constructed, this may need to be checked.
\end{enumerate}

If $h$ is constrained to be a multiple of $3$ as well, then cube roots are
extremely easy to compute in $\mathbb{F}_{q}$:
for all $x \in \mathbb{F}_q$ we see $x^{-(q-2)/3}$ is the cube root of $x$
(cube roots are necessarily unique since each element is a cube).
This may be desirable in some situations, and hardly affects the setup
algorithm.

\section {Type B Curves}

Let $q$ be a prime satisfying $q = 3 \pmod{4}$.
Let $E$ be the curve $y^2 = x^3 + 1$. Then
$E(\mathbb{F}_q)$ is supersingular and $k = 2$.

Again we have $\#E(\mathbb{F}_q) = q+1$ and $\#E(\mathbb{F}_{q^2}) = (q+1)^2$,
thus for any $P\in E(\mathbb{F}_q)$
the embedding degree of $G = \langle P \rangle$ is 2.

Consider the distortion map given by
\[ \Psi(x, y) = (\zeta x, y) \]
where $\zeta$ is a primitive cube root of unity.

Then $\Psi$ maps points of $E(\mathbb{F}_q)$ to points of
$E(\mathbb{F}_{q^2}) \setminus E(\mathbb{F}_q)$. Thus if $f$ denotes the
Tate or Weil pairing, then defining $e:G \times G \rightarrow \mathbb{F}_{q^2}$
by

\[ e(P,Q) = f(P, \Psi(Q)) \]

gives a bilinear nondegenerate map.

We shall see cube roots are easy to find since $q = 2 \pmod{3}$.
For this particular curve, this means we may quickly generate points from
a $y$-coordinate, yielding simple and efficient random point generation and
hashing-to-point routines.
Additionally,
points can be represented by their $y$-coordinate alone since there is
a unique $x$ for each value of $y$.

They do have one drawback however. Unlike the previous type,
there is a certain optimization that
only applies if we forgo symmetry of the pairing. One must choose between
symmetry and efficiency in this case.

\section {Type C Curves}

Define the curves $E^{+} : y^2 = x^3 + 2 x + 1$ over $\F_{3^l}$
and $E^{-} : y^2 = x^3 + 2 x - 1$, also over $\F_{3^l}$.

Unlike all the other curves we consider,
we are work in a low characteristic field. Thus these pairings
are susceptible to certain discrete log attacks due to
Coppersmith~\cite{coppersmith} and are perhaps better avoided.
We describe them here for completeness.

One can show
\[
\#E^+(\F_{3^l}) = \left \{ \begin{array}{rcl}
3^l + 1 + 3^{(l+1)/2} \mbox { when } l = \pm 1 \bmod 12 \\
3^l + 1 - 3^{(l+1)/2} \mbox { when } l = \pm 5 \bmod 12
\end{array} \right.
\]
and $\#E^-(\F_{3^l}) + \#E^+(\F_{3^l}) = 2(3^l + 1)$, that is
\[
\#E^-(\F_{3^l}) = \left \{ \begin{array}{rcl}
3^l + 1 - 3^{(l+1)/2} \mbox { when } l = \pm 1 \bmod 12 \\
3^l + 1 + 3^{(l+1)/2} \mbox { when } l = \pm 5 \bmod 12
\end{array} \right.
\]
and it is easily checked that both types of curve have embedding
degree 6 (that is, the order divide $3^{6l} -1$ in all cases).

For an $l = \pm 1, \pm 5$ and a
curve $E : y^2 = x^3 + 2 x \pm 1$ over $\mathbb{F}_{3^l}$
let $t$ be a root of $t^3 + 2t \pm 2 = 0$, and let $i$ be a
square root of $-1$. These both exist in $\mathbb{F}_{3^{6l}}$.
Define the distortion map $\Psi$ by
\[ \Psi(x,y) = (-x + t, i y) \]
where $x, y$ are elements of $\F_{3^{6l}}$. Then $\Psi$ maps points
of $E(\F_{3^l})$ to points of $E(\F_{3^{6l}})$.

We arrive at a curve selection algorithm as described by
Boneh, Lynn and Shacham~\cite{bls}:

\begin{enumerate}
\item
Choose $l = \pm 1, \pm 5 \bmod 12$. To avoid Weil descent attacks~\cite{weildescent1, weildescent2},
$l$ should not have any small prime factors (say $3,5,7$).
\item
Compute $3^l + l \pm 3^{(l+1)/2}$ and check if either has a large prime
factor $r$.
\item
If so, set $E$ to the corresponding curve equation.
\end{enumerate}

Table~\ref{tbl:typec} shows the first seven cryptographically useful curves
found by this algorithm. Evidently they are far and few between.
Note the third entry has $l = 11^2$. Although this is a fairly low
prime, there has been some evidence suggesting that Weil descent attacks
are still ineffectual for this case~\cite{ghsonodd}.

\begin{table}
\begin{center}
\begin{tabular}{|c|c|c|c|c|c|}

  \hline
  Curve & $l$ & Field       Size      & Group Size         & Finite Field Security \\
        &     & $\lceil\lg_2 q \rceil$ & $\lceil \lg_2 r \rceil$ &
    $\lceil \lg_2 {q^6} \rceil$ \\

  \hline
  $E^-$ & $\phantom079$ & $126$ & $126$ & $752$ \\
  \hline
  $E^+$ & $\phantom097$  & $154$ & $151$ & $923$ \\
  \hline
  $E^+$ & $121$ & $192$ & $155$ & $1151$ \\
  \hline
  $E^+$ & $149$ & $237$ & $220$ & $1417$ \\
  \hline
  $E^+$ & $163$ & $259$ & $256$ & $1551$ \\
  \hline
  $E^-$ & $163$ & $259$ & $259$ & $1551$ \\
  \hline
  $E^+$ & $167$ & $265$ & $262$ & $1589$ \\
  \hline
\end{tabular}
\end{center}
\caption{  \label{tbl:typec}
  Some Type C pairings~\cite{bls}.
}
\end{table}

\section {Complex Multiplication}

Suppose we have integers $D, V, q, t$ satisfying the \emph{CM equation}
\[ D V^2 = 4 q - t^2 \]
such that $D = 0, 3 \bmod 4$ is positive and $q$ is prime.

View the Hilbert polynomial $H_D(x)$ as a polynomial in $\F_q[x]$,
and let $j \in \F_q$ be any root. For $j \ne 0, 1728$, set
$k = j / (1728 - j)$. Then the curve
\[ E: y^2 = x^3 + 3 k c^2 x + 2 k c^3 \]
has $j$-invariant $j$ for any nonzero $c \in \F_q$.

Set $c = 1$. Then $E$ has order $q + t + 1$ or $q - t + 1$.
Generate a random point $P$ of $E$ and check if
$(q-t+1)P = O$. If not, then the order must be $q + t + 1$,
and if we set $c$ to be some quadratic nonresidue in $\F_q$ the
curve will have order $q - t + 1$.

For $j = 0$ the curve has the form $y^2 = x^3 + k$ for some $k$.
For $j = 1728$ the curve has the form $y^2 = x^3 + k x$ for some $k$.
In these cases one can try different values of $k$ until a curve
with the correct order is found.

Thus given a solution the above equation, we may easily write down
a curve of order $q+t-1$ or $q-t-1$.

\section {Type D Curves}

Miyaji et al. describe a method for constructing ordinary elliptic
curves with embedding degree 3, 4 or 6 \cite{mnt}. Moreover, they show
that in a sense, there are no other parametrizations that lead to curves
with these embedding degrees.

We first examine the embedding degree six case, which is the most useful.
The embedding degree three and four cases may also be useful in special
circumstances and we briefly describe them.

Consider the polynomials $q = x^2 + 1, t = \pm x + 1$.
It can be checked that $q(x) + 1 - t(x) \mid q(x)^6 - 1$.

The CM equation becomes $D V^2 = 3 x^2 \pm 2 x + 3$. If we make
the substitution $U = 3x \pm 1$ then we have the generalized Pell equation
\[
U^2 - 3DV^2 = -8
\]

Thus:

\begin{enumerate}
\item
Choose $D$ and solve the Pell-type equation
\[ U^2 - 3DV^2 = -8 \]
\item
We have $U = \pm 1 \pmod 3$. Set $x = (-1 \pm U) / 3$
\item
Check that $q = x^2 + 1$ is prime
\item
Recall $t = \pm x + 1$.
Check that $q - t + 1 = q \mp x$ has a large prime factor $r$.
(Ideally it should be prime.)
\item
Check that $r$ does not divide $q^j = 1$ for any positive integer $j < k$.
(This can be omitted in practice as it is extremely unlikely this will
occur.)
\item
Use the CM method to construct a curve $E$ with order $q \mp x$.
\end{enumerate}

The resulting curve $E$ will have embedding degree 6.

Though this was not how the method was discovered.
we can explain the MNT algorithm via cyclotomic polynomials $\Phi_k(x)$.
Suppose $t = x + 1$.
Recall $\Phi_6(x) = x^2 - x + 1$, thus
$q = x + \Phi_6(x)$.
Then the order $n$ of the resulting
curve $E$ is $n = \Phi_6(x)$, thus
\[ q^6 - 1 = x^6 - 1 \bmod n \]

Recall $\Phi_6(x) \mid x^6 - 1$, hence $n$ must also divide $q^6 - 1$
giving an embedding degree of 6.

Now suppose $t = -x + 1$.
Recall $\Phi_3(x) = x^2 + x + 1$, thus
$q = -x + \Phi_3(x)$.
The order $n$ of $E$ is $n = \Phi_3(x)$, hence
\[ q^6 - 1 = (-x)^6 - 1 = x^6 - 1 \bmod n \]
Since $\Phi_3(x) \mid x^6 - 1$ the embedding degree of $E$ is 6.
Of course $\Phi_3(x) \mid x^3 - 1$ but $x^3 \ne (-x)^3$ in general
thus the embedding degree is not 3 (with high probability).

For an embedding degree of 4, we may also use cyclotomic polynomials.
Recall $\Phi_4(x) = x^2 + 1$. Then set $q = \pm x + \Phi_4(x)$
so that $t = \pm x + 1$. Since $n = \Phi_4(x)$ we have
\[ q^4 - x = (\pm x)^4 - 1 \bmod n \]
thus $n \mid q^4 - 1$.
(When the minus sign is chosen and $x$ replaced by $x+1$ 
we match the notation of Miyaji et al.\cite{mnt}.)

For $k=3$ Miyaji et al. give $q = 3 x^2 - 1$, $t = -1 \pm 3x$ where $x$ is
even.

Scott and Barreto discovered a procedure that finds more curves of these
types than the original MNT algorithm~\cite{moremnt}
which can be viewed as a generalization of a method due to
Barreto, Lynn and Scott~\cite{bals}.

We quote their algorithm without proof, though we suggest how it works
in Section~\ref{sec:balscurves}. In the algorithm, $k$ is 3, 4 or 6.
The CM method is used to construct curves from the algorithm's output.
The choices $h_{max} = 4$ and $D_{max} \approx 10^8$ or so are reasonable.

\begin{algorithm}
\caption {Scott-Barreto generalization of MNT method.}
\begin{algorithmic}[1]
\FOR {$h \gets 1$ to $h_{max}$}
    \FOR {$m \gets 1$ to $4h - 1$}
	\FOR {$D \gets 1$ to $D_{max}$ such that $D$ is squarefree}
	    \STATE solve $DV^2 = 4 h \Phi_k(x) / m - (x-1)^2$ for $x, V$ (generalized Pell equation)
	    \STATE $r\gets \Phi_k(x) /m$
	    \STATE $n\gets hr$
	    \STATE $q\gets n + x$
	    \IF {$q, r$ are both primes}
		\STATE output $q, r, h, D$
	    \ENDIF
	\ENDFOR
    \ENDFOR
\ENDFOR
\end{algorithmic}
\end{algorithm}

Scott and Barreto also concisely state how to transform the CM equation
into a generalized Pell equation:

If $k = 3$, set $a \gets 2h + m$.

If $k = 4$, set $a \gets m$.

If $k = 6$, set $a \gets -2h + m$.

(These three statements can be condensed into
$a \gets (-2 \lfloor k/2 \rfloor + 4)h + m$.)
Set $b \gets 4h - m$. Then the variable substitution
defined by $x = (y-a)/b$ transforms the CM equation into the generalized
Pell equation
\[ y^2 - (mbD)V^2 = (a^2 + b^2) .\]
After solving this equation, we must have $b | y - a$ otherwise $x$ will
not be an integer.

\section {Type E Curves}

Curves of embedding degree 1 are easily constructed using the CM method.
Let $t = 2$, $D = 7$. Let $r$ be a positive integer
and suppose $q = 28 r^2 h^2 + 1$ is prime for some $h$.
Then the CM equation
\[
7 V^2 = 4 (28 (r h)^2 + 1) - 4
\]
is satisfied when we take $V = 4 r h$.

As $H_7(x) = x + 3375$, if we take $k = -3375 / (1728 - 3375)$ in $\F_q$
then the curve
\[
y^2 = x^3 + 3k x + 2k
\]
has order $q - 1$ or $q + 3$. Taking the twist if necessary,
find the curve with order $q-1$.

Note $r \mid q-1$ hence the Tate pairing on this curve can be computed
in $\F_q$. For most applications we choose $r$ to be prime but composite
orders can be chosen instead.

\section {Type F Curves}

By considering cyclotomic polynomials,
Barreto and Naehrig discovered a parametrization yielding embedding
degree 12 curves.

Let $q(x) = 36x^4 + 36x^3 + 24x^2 + 6x + 1$. Let $t(x) = 6x^2 + 1$.
Then if $D = 3$, the CM equation always has the solution
$V = 6x^2 + 4x + 1$. Furthermore,
it turns out $q(x) + 1 - t(x) \mid q(x)^{12} - 1$.
This suggests the following algorithm to generate curves:

\begin{enumerate}
\item
Pick an integer $x$ of a desired magnitude. It may be negative.
\item
Check if $q(x)$ is prime.
\item
Check if $n = q(x) - t(x) + 1$ has a large prime factor $r$.
(Ideally it should be prime.)
\item
Try different values of $k$ until a random point of
$y^2 = x^3 + k$ has order $n$
\end{enumerate}

Barreto and Naehrig recommend the last step be done as follows:
starting from $k = 1$, keep incrementing $k$ until $k+1$ is a quadratic
residue and $n(1,g) = O$, where $g$ is a square root of $k + 1$.

\section {Type G Curves}

Freeman unified many approaches for finding curves in a single
framework\cite{freeman06}, and also showed how to construct curves with
embedding degree 10, with $r$ and $q$ around the same size.
Freeman also notes that it seems unlikely that curves
with embedding degrees other than the ones described in this chapter
can be constructed using these techniques.

We summarize an algorithm due to Freeman and Scott:

Set $q(x) = 25x^4 + 25x^3 + 25x^2 + 10x + 3$ and
$t(x) = 10x^2 + 5x + 3$.

\begin{enumerate}
\item
Choose $D$ such that $D$ is squarefree and $D = 43, 67 \bmod 120$.
\item
Find solutions $(u,v)$ to the equation $u^2 - 15 Dv^2 = -20$.
\item
We have $u = \pm 5 \bmod 15$.
Set $x = (-5 \pm u)/15$.
\item
Check $q(x)$ is prime.
\item
Check $n = q(x) - t(x) + 1$ has a large prime factor $r$.
\item
Construct the corresponding curve $E$ using the CM method.
\end{enumerate}
%Multiply $u+v\sqrt{15 D}$ by a norm-one element of $\mathbb{Q}(\sqrt{15D})$
%and get next candidate

It can be shown that $n \mid q^{10} - 1$ thus the resulting curve has
embedding degree 10.

\begin{table}
\begin{center}
\begin{tabular}{|c|c|c|c|c|c|}

  \hline
  Type & Supersingular & $k$ & Min Input Size & Min Output Size \\
        &     & & $\lceil \lg_2 q \rceil$ & $\lceil \lg_2 {q^k} \rceil$ \\

  \hline
  A & yes & $2$ & $512$ & $1024$ \\
  \hline
  B & yes & $2$ & $512$ & $1024$ \\
  \hline
  C & yes & $6(\approx 3.53)$ & $\approx 305$ & $\approx 1080$ \\
  \hline
  D & no & $6$ & $171$ & $1026$ \\
  \hline
  E & no & $1$ & $1024$ & $1024$ \\
  \hline
  F & no & $12$ & $160$ & $1920$ \\
  \hline
  G & no & $10$ & $160$ & $1600$ \\
  \hline
\end{tabular}
\end{center}
\caption{  \label{tbl:comparepairings}
    Pairing comparison.
}
\end{table}

\section { \label{sec:comparingpairings} Comparing Pairings}

Assuming that 160 bits are sufficient to defeat generic discrete log attacks
and that 1024 bits are sufficient to defeat index calculus, we can use
the embedding degree $k$ to determine a lower bound for $q$.
(In all cases,
for the input we would use a subgroup of the elliptic curve group
with order $r$ around 160 bits.)
The results are shown in Table~\ref{tbl:comparepairings}.

The exact efficacy of the Coppersmith attack on characteristic 3 fields
of cryptographically-useful sizes has yet to be thoroughly investigated.
One conservative estimate by Page, Smart and Vercauteren~\cite{psv}
suggests that the low characteristic
effectively changes the embedding degree $k$ from $6$ to about $5.6 \log 2 / \log 3 \approx 3.53$, suggesting the approximate numbers given in the table.
Incidentally, they correspond to an $E^-$ type C curve with $l=193$
(which does not appear
in Table~\ref{tbl:typec}).

Of course, size is not the only factor. If one must have
a symmetric pairing whose inputs, one is limited to using A, B or C pairings.

If speed is the top priority, then A or B pairings should be used. If symmetry
can be sacrificed as well, then perhaps B pairings are the better choice because
they also allow faster random point generation and point compression.

If a particular group order $r$ is required, one must use A, B or E pairings.

If input size length is important, type D pairings are a good choice.
Type F and G pairings allow only slightly shorter inputs, but are slower.
On the other hand, they guard against future improvements to
finite field discrete log algorithms.

\section {Generalized Pell Equations}

For completeness we describe how to solve the Diophantine equations that arise
when searching for some of the above pairing types.

Consider the \emph{Pell equation}
\[ x^2 - D y^2 = 1 \]
where $D$ is not a square, $x, y$ are integers.
We solve such an equation using the
continued fraction expansion of $\sqrt{D}$:
\[
\begin{array}{rcl}
P_0 &=& 0 \\
Q_0 &=& 1 \\
a_0 &=& \left\lfloor{\sqrt{D}}\right\rfloor \\
P_1 &=& a_0 \\
Q_1 &=& D-a_0^2 \\
a_n &=& \left\lfloor { \frac {a_0 + P_n}{Q_n} } \right\rfloor \\
P_n &=& a_{n-1} Q_{n-1} - P_{n-1} \\
Q_n &=& \frac{D - P_n^2}{Q_{n-1}}
\end{array}
\]

One can show for some $k$ we must have $a_{k+1} = 2 a_0$, and after
this point the $a_n$ sequence begins repeating. That is
$\sqrt{D} = [a_0, a_1, ..., a_{k+1}, a_1, ..., a_{k+1}, ... ]$.

The convergents are given by
\[ p_0 = a_0, p_1 = a_0 a_1 + 1, p_n = a_n p_{n-1} + p_{n-2} \]
and
\[ q_0 = 1, q_1 = a_1, q_n = a_n q_{n-1} + q_{n-2} .\]
These satisfy
\[ p_n^2 - D q_n^2 = (-1)^{n+1} Q_{n+1} . \]

It turns out that $(x, y) = (p_k, q_k)$ is the smallest positive
integer equation
of the Pell equation for odd $k$, and $(x, y) = (p_{2k+1}, q_{2k+1}$ is for
even $k$. Denote this minimal positive solution by $(t, u)$.
Then all positive solutions $(x, y)$ to the Pell equation can be found via
\[ x + y\sqrt{D} = (t+u\sqrt{D})^n\]
(for all positive integers $n$). The negative solutions (which we
never need) in this case are trivial to find from the positive solutions.

\subsection {Generalized Pell Equations}

Now suppose we are to solve the \emph{generalized Pell equation}
\[ x^2 - D y^2 = N \]
where $D$ is not a square, $x, y$ are integers.

When $N^2 < D$ we first solve the Pell equation
\[ x^2 - D y^2 = 1 \]
using the above method, that is, computing convergents $p_n, q_n$
until the minimal positive solution is found. However,
while doing so, we check if $p_n^2 - D q_n^2 = N / f^2$ for
some positive integer $f$. If so, then we append $(f p_n, f q_n)$ to
the list of solutions of the generalized Pell equation.

If no such convergents are found by the time we have reached the minimal
positive solution for the Pell equation, then the generalized Pell
equation has no solution.

Otherwise let $(t, u)$ be the minimal positive solution of the above
Pell equation.
Then for each $(r,s)$ on the list of solutions we have a family of
solutions $(x,y)$ given by
\[ (x+y\sqrt{D}) = (r+s\sqrt{D})(t+u\sqrt{D})^n \]
(for all positive integers $n$). These families account for all positive
integer solutions to the generalized Pell equation.

When $N^2 \ge D$ there are possibly other fundamental solutions
to the generalized Pell equation we must add to the list before generating
families of solutions.
We can use brute force to find them if the numbers are small enough.

For positive $N$ set $L_1=0, L_2 =\sqrt{N(t-1)/2D}$. For negative $N$
set $L_1 = \sqrt{-N/D}, L_2=\sqrt{-N(t+1)/2D)}$. For all integers $y$
satisfying $L_1\le y \le L_2$ check if there exists any integer $x$ such that
$x^2 - Dy^2 = N$.
Append any solutions $(x,y)$ to our list. Also append $(x,-y)$ if
it does not appear in the family of solutions generated by $(x, y)$.

\section {Hilbert Polynomials}

We quote an algorithm to compute Hilbert class
polynomials as described by Cohen~\cite[section 7.6.2]{1993-cohen}.
We need roots of these polynomials over certain fields in order to generate
some of the above pairing types, a procedure we shall describe in
Section~\ref{sec:rootfinding}.

Let $\tau \in \mathbb{C}$ lie in the upper complex plane.
Set $q = e^{2 i \pi \tau}$. Define
\[
\Delta(\tau) = q\left(1+\sum_{n\ge1}(-1)^n
\left({q^{n(3n-2)/2} + q^{n(3n+1)/2}}\right)\right)^{24}
\]
and
\[
f(\tau) = \frac{\Delta(2\tau)}{\Delta(\tau)}
\]
and finally
\[
j(\tau) = \frac{(256 f(\tau) + 1)^3}{f(\tau)}
\]
Then the Hilbert class polynomial for the discriminant $-D$ is
given by
\[ H_D(x) = \prod (X - j(\alpha) \]
where $\alpha$ runs over all complex numbers such that
\[ \alpha = \frac{-b+\sqrt{-D}}{2a} \]
where $ax^2 + bxy + cy^2$ is a \emph{primitive reduced positive definite
binary quadratic form} of discriminant $-D$, or in other words,
$b^2 - 4ac = -D$, $|b| \le a \le \sqrt{|D|/3}$, $\gcd(a,b,c)=1$ and
if $|b| = a$ or $a=c$ then $b\ge0$.

Hence the following algorithm computes Hilbert class polynomials.
Here, $P$ is a polynomial variable, and $D = 0, -1 \pmod 4$.

\begin{algorithm}
\caption {Hilbert class polynomial computation: $P \gets H_D(X)$}
\begin{algorithmic}[1]
\STATE $P\gets 1$
\STATE $b\gets D \pmod 2$
\STATE $B\gets \left\lfloor\sqrt{|D|/3}\right\rfloor$
\REPEAT
    \STATE $b\gets b+2$
    \STATE $t\gets (b^2+D)/4$
    \STATE $a\gets \max(b,1)$
    \REPEAT
	\IF {$a^2 \mid t$}
	    \STATE $u\gets j((-b+\sqrt{D})/(2a))$
	    \IF {$a = b$ or $a^2 = t$ or $b=0$}
		\STATE $P \gets P(X-u)$
	    \ELSE
		\STATE $P \gets P(X^2 - 2\Re(u)X+|u|^2)$
	    \ENDIF
	\ENDIF
	\STATE $a=a+1$
    \UNTIL $a^2>t$
    \STATE $b=b+2$
\UNTIL $b>B$
\STATE round coeffcients of $P$ to nearest integer
\RETURN $P$
\end{algorithmic}
\end{algorithm}

It remains to specify the precision of the floating point operations.
Cohen recommends using at least $k + 10$ significant digits where
\[ k = \pi \frac{\sqrt{|D|}} {\ln 10} \sum \frac{1}{a} \]
the sum running over all reduced forms $(a,b,c)$ of discriminant $D$,
which can be computed using the following algorithm~\cite[Algorithm 5.3.5]{1993-cohen}:

\begin{algorithm}
\caption {Counting reduced forms: $s \gets \#$forms of discriminant $D$}
\begin{algorithmic}[1]
\STATE $s\gets 1$, $b\gets D \pmod 2$, $B\gets \left\lfloor \sqrt{|D|/3}
\right\rfloor$.
\REPEAT
    \REPEAT
	\STATE $q\gets (b^2 - D)/4$, $a\gets b$
	\IF {$a\le 1$}
	    \STATE $a\gets 1$
	\ELSIF {$a\mid q$}
	    \IF {$a=b$ or $a^2=q$ or $b=0$}
		\STATE $s=s+1/a$
	    \ELSE
		\STATE $s=s+2/a$
	    \ENDIF
	\ENDIF
	\STATE $a\gets a+1$
    \UNTIL $a^2>q$
    \STATE $b\gets b+2$
\UNTIL $b>B$
\RETURN $s$
\end{algorithmic}
\end{algorithm}

\section {\label{sec:balscurves} Arbitrary Embedding Degree}

What if other embedding degrees are desired? It turns out that given any
positive integer $k$ we can in fact construct pairings with embedding degee $k$,
but the subgroup size $r$ will have far fewer bits than $q$,
the size of the field.

We define $\rho = \lg q / \lg r$. This $\rho$ is in some sense
a measure of inefficiency: although we only have $r$-bit (generic group)
discrete log security, we must perform our computations on $\rho r$-bit numbers.

Our main focus is $\rho \approx 1$ pairings, but we now take a small detour
and describe an algorithm to find
pairings with any given embedding degree $k$ due to Barreto, Lynn and Scott~\cite{bals}.

In fact, this algorithm is relevant to the previous section.
A variation of this approach leads to $\rho \approx 1$ type D
curves that the method of Miyaji et al. does not find~\cite{moremnt}.

\begin{lemma}
Let $E(\Fq)$ be an elliptic curve and suppose it has
$n = q - t + 1$ points, where $t$ is the trace of Frobenius.
Let $n = h r$ where $r$ is prime.
Then the embedding degree (of the subgroup of order $r$) of $E(\Fq)$ is $k$.
if and only if
$r \mid \Phi_k(t-1)$ and $r \nmid \Phi_i(t-1)$ for all $1 \le i < k$,
where $\Phi_i$ denotes the $i$th cyclotomic polynomial.
\end{lemma}

\begin{proof}
Then $q = t - 1 \pmod r$. Given any integer $i$, exponentiating both sides
and subtracting 1 gives
\[ q^i - 1 = (t-1)^i -1 \pmod r \]
hence if $E$ has embedding degree $k$ for the subgroup of $E(\Fq)$ of order $r$
then $r \mid (t-1)^k - 1$ and $r \nmid (t-1)^i - 1$ for $1 \le i < k$.

Thus $r \nmid \Phi_i(t-1)$ for $1 \le i < k$ otherwise the embedding degree
would be strictly less than $k$. Since $r$ is prime we must have
$r \mid \Phi_k(t-1)$.
\end{proof}

This suggests the following general strategy to finding a curve with
a subgroup of order $r$ with given embedding degree $k$:

\begin{theorem}
Choose an integer $x$ with $|x| > 1$ and any factor $r$ of
$\Phi_k(x)$.
Choose an integer $d$.
Choose any positive integer $h$. Let $n = hr$, $q = n + x^d, t = x^d + 1$
(thus $n = q - t + 1$).
Suppose $r \nmid \Phi_i(x^d)$ for $1 \le i < k$.

Then if $q$ is prime and $E(\Fq)$ is a (nonsingular)
elliptic curve of order $n$, then
any cyclic subgroup of $E(\Fq)$ of order dividing
$r$ has embedding degree $k$.
\end{theorem}

\begin{proof}
By construction, $t-1 = x^d$, hence $\Phi_i(t-1) \mid x^{id} - 1$ for
any positive integer $i$.
By choice of $r$
$r \mid \Phi_k(x)$ thus $r \mid x^k - 1 \mid x^{kd} - 1$ and
$r \nmid \Phi_i(t-1)$.

Applying the previous lemma completes the proof.
\end{proof}

Alternative parametrizations are possible. For example, when $k$ is twice
an odd number, and $d$ is even, we may use $t = -x^d + 1, q = n - x^d$.

An obvious generalization for the $t = x^d + 1$ case is
$q = n + \Phi_k(x)g(x) + x^d$ for any polynomial $g(x)$, though care must
be taken to stay within the Hasse bound: we require $x^d$ to cancel out the
term of highest degree in $\Phi_k(x)g(x)$ and that the remaining terms have
sufficiently low degree. For example, for $k=9$ we can pick $g(x)$ to obtain
$q = n - x^3 - 1$.

In practice we choose $d$ satisfying $1 \le d \le \deg \Phi_k /2$,
otherwise the Hasse bound is broken so such a curve $E(\Fq)$ cannot exist and
the theorem becomes an empty statement.
Also $r$ is usually taken to be the largest prime dividing $\Phi_k(x)$,
which almost never divides $\Phi_i(x^d)$ for $1 \le i < k$.

It remains to show how to construct a curve given these parameters. We shall
employ the CM method.
Recall $r \mid \Phi_k(x)$, so write $m r = \Phi_k(x)$.
The CM equation becomes

\[ D V^2 = 4 h \Phi_k(x) / m -(x^d-1)^2 . \]

If $k=3,4,6$ then $\deg \Phi_k = 2$.
Set $m = 1$.
Picking some small value for $h$ and fixing $D$ yields
a Diophantine equation that can be transformed into a Pell-type equation,
which can be solved to find $x$ and $V$. With luck, $\Phi_k(x)$ will be
prime or a small number times a prime, giving a $\rho \approx 1$ pairing.
When $h=1$ we have the equivalent of the MNT method.

Fixing $h$ and $D$ for higher degree cyclotomic polynomials
$\Phi_k$ result in higher degree Diophantine equations which are not easily
solved.

Instead, if $D$ is now viewed as a variable and $x$ if fixed,
(and $h$ is still fixed) we can find integer solutions for $D$ and $V$
easily. Unfortunately, for cryptographically-useful choices of $x$,
the integer $D$ is too large to allow the Hilbert class field polynomial $H_D$
to be computed.
However, by using small $x$ we can exhibit toy examples of high
embedding degree curves with $\rho \approx 1$.

Now consider fixing $D$ and $x$. In particular, $D$ is small enough so
that $H_D$ can be computed and $x$ is large enough to be cryptographically
useful.This gives a Diophantine
equation of the form
\[ D V^2 = Ah - B \]
where $D, A, B$ are integer constants. We can solve for $V$ and $h$ and
obtain a curve containing a cyclic subgroup of order $r$
with embedding degree $k$. There is a drawback however: $h$ tends to be close
in size to $r$, giving $\rho \approx 2$.

We have set $m = 1$ above. More generally,
when $k = 3,4,6$, if $m$ is allowed to be some small integer then one
can find curves with low $h$ that are not found using the MNT method as
originally described ~\cite{moremnt}.

Freeman, Scott and Teske~\cite{fst} note the approach of Barreto, Lynn and
Scott is a special case of a more recent construction by
Brezing and Weng~\cite{bw}. which in turn can be thought of as a specific
application of a general strategy suggested by Cocks and Pinch~\cite{cp}.

Other methods to construct pairings of arbitrary embedding degree,
some of which with $\rho$ substantially less than 2, are beyond our scope.
For details, refer to Freeman, Scott and Teske~\cite{fst}.
