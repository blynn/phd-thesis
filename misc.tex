\chapter{Miscellaneous Optimizations}

We describe various
optimizations unrelated to pairings, or elliptic curves in general.

\section{Dedicated Squaring}

For each field, ring or group, dedicated squaring or doubling routines
can be helpful. The savings accrued during exponentiations can be significant.

\section{Field Extensions}

When possible, a degree two field extension of a field $\mathbb{F}_q$
should be implemented as $\mathbb{F}_q[i]$ where $i$ is a square root of $-1$.
This can be done if and only if $q = 3 \pmod{4}$.

We have
\[ (a + i b)^2 = (a - b)(a + b) + i (2 a b) \]
and
\[ (a + i b)(c + i d) = (ac - bd) + i[(a + b)(c + d) - ac - bd] \]

More generally, for low degree extensions (e.g. 3, 6),
hand-coded generalized Karatsuba multiplication algorithms \cite{wpkaratsuba}
will improve running times.

\section{Finding a Root of a Polynomial}

When computing parameters for curves using the CM method, we
need to find a root of a Hilbert polynomial modulo a prime.
As we only want a single root, we may use the Cantor-Zassenhaus
method and skip many steps. For example, we do not care about
the multiplicity of the factors or factors of degree higher than 1.
Thus we may do the folliowing to find a root of a
degree $n$ polynomial $f(x)$ in
$\F_q$.

\begin{enumerate}
\item
Compute $g(x) = \gcd(x^q - x, f(x))$.
\item
If $\deg g = 1$ then output the root and stop.
\item
Pick a random $r \in \Fq$. If $r$ is a root then stop.
\item
Compute $s(x) = (x-r)^{(q-1)/2} \bmod g(x)$.
\item
Compute $g'(x) = \gcd(s(x)+1, g(x))$. This is a proper factor of $g$
with probability $1 - 2^{n-1}$. So if $g'(x) \ne 1$ set $g = g'$ and
goto step 2.
\item
Goto step 3.
\end{enumerate}
